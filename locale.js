const translations = {
    en: {
        "nav.work": "Work",
        "nav.ventures": "Ventures",
        "nav.writing": "Writing",
        "nav.back_writing": "â† Writing",
        "writing.archives": "Archives (Substack)",
        "home.headline": "Architecting digital platforms & building businesses for Africa & beyond.",
        "home.role": "Solutions Architect & Tinkerer",
        "home.location": "Accra, Ghana ğŸ‡¬ğŸ‡­",
        "home.label_role": "Role",
        "home.label_base": "Base",
        "home.mission": "Solutions Architect & Tinkerer based in Accra, Ghana ğŸ‡¬ğŸ‡­. Currently exploring the intersection of design, technology, and culture.",
        "home.say_hi": "My Story",
        "puzzle.title": "Quick Check",
        "puzzle.desc": "Solve to say hi:",
        "video.caption": "Thanks for checking in! ğŸ‰",
        "btn.cancel": "Cancel",
        "btn.verify": "Verify",
        "section.selected_works": "Selected Works",
        "section.initiatives": "Initiatives",
        "section.writing": "Writing",
        "section.ventures": "Ventures",
        "footer.email": "Email",
        "footer.twitter": "Twitter",
        "footer.linkedin": "LinkedIn",
        "footer.github": "GitHub",
        "ventures.intro": "A collection of commercial ventures and experiments in Ghana ğŸ‡¬ğŸ‡­.",
        "writing.intro": "Thoughts on technology, design, and building products.",
        "writing.articles": "Articles",
        "proj.amigo": "Verified roommate finder.",
        "proj.gatepass": "First video-powered marketplace for events.",
        "proj.happening": "A real-time \"Departure Board\" for live events.",
        "proj.itinero": "AI-powered travel planner for Africa.",
        "proj.knitted": "Business OS for tailors to record measurements.",
        "proj.lazypick": "Solving decision paralysis for movies & food.",
        "proj.motorambos": "Connecting car owners with mechanics.",
        "proj.stage": "Vendor discovery platform for events.",
        "proj.sandbox": "Digital network connecting creators.",
        "proj.minutes": "Speed Dating Event Series.",
        "proj.monochrome": "Premium affordable, modular furniture that adapt to changing needs.",
        "proj.outpost": "A serene cluster of sustainable off-grid tiny homes designed for rest.",
        "proj.vita": "Sustainable Agriculture.",
        "proj.loosewear": "Undergarments & sleepwear for everyday comfort. Soft, breathable, easy-to-wear.",
        "proj.offstage": "A platform for intimate theatre experiences and modern storytelling in Accra.",
        "meta.marketplace": "Marketplace",
        "meta.eventtech": "Event Tech",
        "meta.aitravel": "AI Travel",
        "meta.saas": "SaaS",
        "meta.lifestyle": "Lifestyle App",
        "meta.service": "Service",
        "meta.platform": "Platform",
        "meta.community": "Community",
        "meta.events": "Events",
        "meta.furniture": "Furniture",
        "meta.hospitality": "Hospitality",
        "meta.agro": "Agro",
        "meta.apparel": "Apparel",
        "meta.theatre": "Theatre",
        "error.not_found": "The page you're looking for doesn't exist.",
        "error.return_home": "Return Home"
    },
    fr: {
        "nav.work": "Travail",
        "nav.ventures": "Entreprises",
        "nav.writing": "Ã‰criture",
        "nav.back_writing": "â† Ã‰criture",
        "writing.archives": "Archives (Substack)",
        "nav.back_writing": "â† Ã‰criture",
        "writing.archives": "Archives (Substack)",
        "home.intro": "Je suis un Architecte de Solutions & Bricoleur basÃ© Ã  Accra, Ghana ğŸ‡¬ğŸ‡­ <span style='color: var(--text-tertiary);' id='clock'></span>. Je construis des produits qui rÃ©solvent des problÃ¨mes en Afrique et au-delÃ .",
        "home.headline": "Architecte de plateformes numÃ©riques et crÃ©ateur d'entreprises.",
        "home.role": "Architecte de Solutions & Bricoleur",
        "home.location": "Accra, Ghana ğŸ‡¬ğŸ‡­",
        "home.label_role": "RÃ´le",
        "home.label_base": "Base",
        "home.mission": "Architecte de Solutions & Bricoleur basÃ© Ã  Accra, Ghana ğŸ‡¬ğŸ‡­. Actuellement, j'explore l'intersection du design, de la technologie et de la culture.",
        "home.say_hi": "Mon Histoire",
        "puzzle.title": "VÃ©rification Rapide",
        "puzzle.desc": "RÃ©soudre pour dire bonjour:",
        "video.caption": "Merci de votre visite! ğŸ‰",
        "btn.cancel": "Annuler",
        "btn.verify": "VÃ©rifier",
        "section.selected_works": "Travaux SÃ©lectionnÃ©s",
        "section.initiatives": "Initiatives",
        "section.writing": "Ã‰criture",
        "section.ventures": "Entreprises",
        "footer.email": "Email",
        "footer.twitter": "Twitter",
        "footer.linkedin": "LinkedIn",
        "footer.github": "GitHub",
        "ventures.intro": "Une collection d'entreprises commerciales et d'expÃ©rimentations au Ghana ğŸ‡¬ğŸ‡­.",
        "writing.intro": "RÃ©flexions sur la technologie, le design et la crÃ©ation de produits.",
        "writing.articles": "Articles",
        "proj.amigo": "Chercheur de colocataires vÃ©rifiÃ©.",
        "proj.gatepass": "PremiÃ¨re place de marchÃ© vidÃ©o pour les Ã©vÃ©nements.",
        "proj.happening": "Un \"Tableau de DÃ©parts\" en temps rÃ©el pour les Ã©vÃ©nements en direct.",
        "proj.itinero": "Planificateur de voyage alimentÃ© par l'IA pour l'Afrique.",
        "proj.knitted": "OS d'entreprise pour les tailleurs pour enregistrer les mesures.",
        "proj.lazypick": "RÃ©soudre la paralysie dÃ©cisionnelle pour les films et la nourriture.",
        "proj.motorambos": "Mise en relation des propriÃ©taires de voitures avec des mÃ©caniciens.",
        "proj.stage": "Plateforme de dÃ©couverte de fournisseurs pour les Ã©vÃ©nements.",
        "proj.sandbox": "RÃ©seau numÃ©rique connectant les crÃ©ateurs.",
        "proj.minutes": "SÃ©rie d'Ã©vÃ©nements de Speed Dating.",
        "proj.monochrome": "Meubles modulaires haut de gamme et abordables qui s'adaptent aux besoins changeants.",
        "proj.outpost": "Un groupe serein de petites maisons durables hors rÃ©seau conÃ§ues pour le repos.",
        "proj.vita": "Agriculture Durable.",
        "proj.loosewear": "Sous-vÃªtements et vÃªtements de nuit pour le confort quotidien. Doux, respirant, facile Ã  porter.",
        "proj.offstage": "Une plateforme pour des expÃ©riences thÃ©Ã¢trales intimes et des rÃ©cits modernes Ã  Accra.",
        "meta.marketplace": "Place de marchÃ©",
        "meta.eventtech": "Technologie Ã‰vÃ©nementielle",
        "meta.aitravel": "Voyage IA",
        "meta.saas": "SaaS",
        "meta.lifestyle": "App Mode de Vie",
        "meta.service": "Service",
        "meta.platform": "Plateforme",
        "meta.community": "CommunautÃ©",
        "meta.events": "Ã‰vÃ©nements",
        "meta.furniture": "Meubles",
        "meta.hospitality": "HÃ´tellerie",
        "meta.agro": "Agro",
        "meta.apparel": "VÃªtements",
        "meta.theatre": "ThÃ©Ã¢tre",
        "error.not_found": "La page que vous recherchez n'existe pas.",
        "error.return_home": "Retour Ã  l'accueil"
    },
    es: {
        "nav.work": "Trabajo",
        "nav.ventures": "Empresas",
        "nav.writing": "Escritura",
        "nav.back_writing": "â† Escritura",
        "writing.archives": "Archivos (Substack)",
        "nav.back_writing": "â† Escritura",
        "writing.archives": "Archivos (Substack)",
        "home.intro": "Soy Arquitecto de Soluciones y Experimentador basado en Accra, Ghana ğŸ‡¬ğŸ‡­ <span style='color: var(--text-tertiary);' id='clock'></span>. Construyo productos que resuelven problemas en Ãfrica y mÃ¡s allÃ¡.",
        "home.headline": "Arquitecto de plataformas digitales y constructor de negocios.",
        "home.role": "Arquitecto de Soluciones y Inventor",
        "home.location": "Accra, Ghana ğŸ‡¬ğŸ‡­",
        "home.label_role": "Rol",
        "home.label_base": "Base",
        "home.mission": "Arquitecto de Soluciones y Experimentador basado en Accra, Ghana ğŸ‡¬ğŸ‡­. Actualmente explorando la intersecciÃ³n del diseÃ±o, la tecnologÃ­a y la cultura.",
        "home.say_hi": "Mi Historia",
        "puzzle.title": "VerificaciÃ³n RÃ¡pida",
        "puzzle.desc": "Resolver para saludar:",
        "video.caption": "Â¡Gracias por visitar! ğŸ‰",
        "btn.cancel": "Cancelar",
        "btn.verify": "Verificar",
        "section.selected_works": "Trabajos Seleccionados",
        "section.initiatives": "Iniciativas",
        "section.writing": "Escritura",
        "section.ventures": "Empresas",
        "footer.email": "Correo",
        "footer.twitter": "Twitter",
        "footer.linkedin": "LinkedIn",
        "footer.github": "GitHub",
        "ventures.intro": "Una colecciÃ³n de empresas comerciales y experimentos en Ghana ğŸ‡¬ğŸ‡­.",
        "writing.intro": "Pensamientos sobre tecnologÃ­a, diseÃ±o y construcciÃ³n de productos.",
        "writing.articles": "ArtÃ­culos",
        "proj.amigo": "Buscador de compaÃ±eros de piso verificado.",
        "proj.gatepass": "Primer mercado impulsado por video para eventos.",
        "proj.happening": "Un \"Tablero de Salidas\" en tiempo real para eventos en vivo.",
        "proj.itinero": "Planificador de viajes impulsado por IA para Ãfrica.",
        "proj.knitted": "Sistema operativo empresarial para que los sastres registren medidas.",
        "proj.lazypick": "Resolviendo la parÃ¡lisis de decisiÃ³n para pelÃ­culas y comida.",
        "proj.motorambos": "Conectando propietarios de automÃ³viles con mecÃ¡nicos.",
        "proj.stage": "Plataforma de descubrimiento de proveedores para eventos.",
        "proj.sandbox": "Red digital que conecta a creadores.",
        "proj.minutes": "Serie de eventos de citas rÃ¡pidas.",
        "proj.monochrome": "Muebles modulares premium y asequibles que se adaptan a las necesidades cambiantes.",
        "proj.outpost": "Un grupo sereno de pequeÃ±as casas sostenibles fuera de la red diseÃ±adas para el descanso.",
        "proj.vita": "Agricultura Sostenible.",
        "proj.loosewear": "Ropa interior y de dormir para la comodidad diaria. Suave, transpirable, fÃ¡cil de llevar.",
        "proj.offstage": "Una plataforma para experiencias teatrales Ã­ntimas y narraciÃ³n moderna en Accra.",
        "meta.marketplace": "Mercado",
        "meta.eventtech": "TecnologÃ­a de Eventos",
        "meta.aitravel": "Viajes IA",
        "meta.saas": "SaaS",
        "meta.lifestyle": "App de Estilo de Vida",
        "meta.service": "Servicio",
        "meta.platform": "Plataforma",
        "meta.community": "Comunidad",
        "meta.events": "Eventos",
        "meta.furniture": "Muebles",
        "meta.hospitality": "Hospitalidad",
        "meta.agro": "Agro",
        "meta.apparel": "Ropa",
        "meta.theatre": "Teatro",
        "error.not_found": "La pÃ¡gina que buscas no existe.",
        "error.return_home": "Volver al inicio"
    }
};

function setLanguage(lang) {
    if (!translations[lang]) return;

    // Save preference
    localStorage.setItem('lang', lang);

    // Update URL if supported
    const url = new URL(window.location);
    if (url.searchParams.get('lang') !== lang) {
        url.searchParams.set('lang', lang);
        window.history.replaceState({}, '', url);
    }

    // Update DOM
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[lang][key]) {
            // Check if content has HTML (like the clock span in intro)
            if (translations[lang][key].includes('<')) {
                el.innerHTML = translations[lang][key];
                // If we replaced the clock, we need to make sure the clock updater still works.
                // The clock updater uses getElementById('clock'), so as long as the ID is there, it should find it on next tick.
                // However, we should probably manually trigger an update or let the interval handle it.
                if (key === 'home.intro') {
                    // Re-trigger clock update if function exists
                    if (typeof updateTime === 'function') updateTime();
                }
            } else {
                // Special handling for location to preserve clock if needed, though clock is separate now in new structure.
                // Actually, the new structure has the clock OUTSIDE the translated span.
                // <span data-i18n="home.location">Accra, Ghana ğŸ‡¬ğŸ‡­</span> <span id="clock"></span>
                // So simple text replacement is fine for home.location.
                el.textContent = translations[lang][key];
            }
        }
    });

    // Update active state in switcher
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.toggle('active', btn.getAttribute('data-lang') === lang);
    });
}

function initLanguage() {
    const urlParams = new URLSearchParams(window.location.search);
    const savedLang = localStorage.getItem('lang');
    const browserLang = navigator.language.slice(0, 2);

    let lang = urlParams.get('lang') || savedLang || (['fr', 'es'].includes(browserLang) ? browserLang : 'en');

    // Default to EN if invalid
    if (!translations[lang]) lang = 'en';

    setLanguage(lang);

    // Add click listeners to switcher
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            setLanguage(e.target.getAttribute('data-lang'));
        });
    });
}

document.addEventListener('DOMContentLoaded', initLanguage);
